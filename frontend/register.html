<!DOCTYPE html>
<html lang="en">
<head>
  <title>Sign Up | Sampada Tours & Travels</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Create an account with Sampada Tours & Travels for exclusive travel packages and benefits">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>

<header class="main-header">
  <div class="logo">
    <a href="index.html">Sampada Tours & Travels</a>
  </div>
  <nav class="main-nav">
    <a href="index.html">Home</a>
    <a href="tours.html">Tours</a>
    <a href="car-rentals.html">Car Rentals</a>
    <a href="booking-dashboard.html" >My Bookings</a>
    <a href="feedback.html">Feedback</a>
  </nav>
  <div class="auth-links" id="authLinks"></div>
</header>

<main class="auth-container">
  <div class="auth-box">

    <h2><i class="fas fa-user-plus"></i> Create Your Account</h2>
    <p class="auth-message">Join Sampada Tours & Travels for exclusive benefits!</p>

    <div id="alertBox" class="alert-box" role="alert" style="display: none;"></div>

    <form id="registerForm" class="auth-form" novalidate>

      <div class="form-group icon-input">
        <label for="fullName">Full Name</label>
        <div class="input-wrapper">
          <i class="fas fa-user icon"></i>
          <input type="text" id="fullName" placeholder="Your full name" required>
        </div>
        <span id="fullNameError" class="error-message"></span>
      </div>

      <div class="form-group icon-input">
        <label for="phone">Phone Number</label>
        <div class="input-wrapper">
          <i class="fas fa-phone icon"></i>
          <input type="tel" id="phone" placeholder="9876543210" required maxlength="10">
        </div>
        <span id="phoneError" class="error-message"></span>
      </div>

      <div class="form-group icon-input">
        <label for="email">Email</label>
        <div class="input-wrapper">
          <i class="fas fa-envelope icon"></i>
          <input type="email" id="email" placeholder="your@email.com" required>
        </div>
        <span id="emailError" class="error-message"></span>
      </div>

      <div class="form-group icon-input">
        <label for="password">Password</label>
        <div class="input-wrapper password-wrapper">
          <i class="fas fa-key icon"></i>
          <input type="password" id="password" placeholder="Create a strong password" required minlength="8">
          <span class="password-toggle" id="togglePassword">
            <i class="fas fa-eye"></i>
          </span>
        </div>
        <span id="passwordError" class="error-message"></span>
      </div>


      <div class="password-rules">
        <p id="rule-length"><span>✖</span> 8–20 characters</p>
        <p id="rule-upper"><span>✖</span> At least one capital letter</p>
        <p id="rule-number"><span>✖</span> At least one number</p>
        <p id="rule-special"><span>✖</span> At least one special character (@ # $ % ^ & * !)</p>
        <p id="rule-space"><span>✖</span> No spaces</p>
      </div>



      <div class="form-group icon-input">
        <label for="confirmPassword">Confirm Password</label>
        <div class="input-wrapper password-wrapper">
          <i class="fas fa-lock icon"></i>
          <input type="password" id="confirmPassword" placeholder="Re-enter password" required>
          <span class="password-toggle" id="toggleConfirmPassword">
            <i class="fas fa-eye"></i>
          </span>
        </div>
        <span id="confirmPasswordError" class="error-message"></span>
      </div>


      <button type="submit" class="btn-submit auth-submit-btn" id="submitBtn">
        <i class="fas fa-user-check"></i> Sign Up
      </button>

      <p class="alt-action">
        Already have an account?
        <a href="login.html" class="auth-link">Log In Here</a>
      </p>

    </form>
  </div>
</main>

<footer class="main-footer">
  <div class="footer-content">
    <p>Sampada Tours & Travels</p>
    <p class="address"><i class="fas fa-map-marker-alt"></i> Kirana Bazar Road, Mominpura, Kalaburagi, Karnataka</p>
    <p class="copyright">© 2025 Sampada Tours & Travels</p>
  </div>
</footer>

<!-- Central Auth -->
<script src="auth.js"></script>


<script>
document.addEventListener("DOMContentLoaded", () => {

  AUTH.updateAuthUI();

  const form = document.getElementById("registerForm");
  const alertBox = document.getElementById("alertBox");

  const fullName = document.getElementById("fullName");
  const phone = document.getElementById("phone");
  const email = document.getElementById("email");
  const passwordInput = document.getElementById("password");
  const confirmPasswordInput = document.getElementById("confirmPassword");

  const togglePassword = document.getElementById("togglePassword");
  const toggleConfirmPassword = document.getElementById("toggleConfirmPassword");

  const ruleLength = document.getElementById("rule-length");
  const ruleUpper = document.getElementById("rule-upper");
  const ruleNumber = document.getElementById("rule-number");
  const ruleSpecial = document.getElementById("rule-special");
  const ruleSpace = document.getElementById("rule-space");

  /* ===========================
     HELPERS
  =========================== */
  function showAlert(message, type = 'error') {
    alertBox.textContent = message;
    alertBox.className = `alert-box ${type}`;
    alertBox.style.display = 'block';
    setTimeout(() => alertBox.style.display = 'none', 5000);
  }

  function showFieldError(fieldId, message) {
    const field = document.getElementById(fieldId);
    const errorSpan = document.getElementById(`${fieldId}Error`);
    field.closest('.form-group').classList.add('error');
    errorSpan.textContent = message;
    errorSpan.style.display = 'block';
  }

  function clearFieldError(fieldId) {
    const field = document.getElementById(fieldId);
    const errorSpan = document.getElementById(`${fieldId}Error`);
    field.closest('.form-group').classList.remove('error');
    errorSpan.textContent = '';
    errorSpan.style.display = 'none';
  }

  function validateEmail(email) {
    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email.toLowerCase());
  }

  function validatePhone(phone) {
    return /^[0-9]{10}$/.test(phone);
  }

  /* ===========================
     SHOW / HIDE PASSWORDS
  =========================== */
  function toggleVisibility(input, toggleEl) {
    const type = input.type === "password" ? "text" : "password";
    input.type = type;
    const icon = toggleEl.querySelector('i');
    icon.className = type === "password" ? "fas fa-eye" : "fas fa-eye-slash";
  }

  if (togglePassword) {
    togglePassword.addEventListener("click", () => {
      toggleVisibility(passwordInput, togglePassword);
    });
  }

  if (toggleConfirmPassword) {
    toggleConfirmPassword.addEventListener("click", () => {
      toggleVisibility(confirmPasswordInput, toggleConfirmPassword);
    });
  }

  /* ===========================
     PASSWORD RULE CHECKER
  =========================== */
  function toggleRule(element, isValid) {
    const icon = element.querySelector("span");
    if (isValid) {
      element.classList.add("valid");
      icon.textContent = "✔";
    } else {
      element.classList.remove("valid");
      icon.textContent = "✖";
    }
  }

  passwordInput.addEventListener("input", () => {
    const value = passwordInput.value;

    toggleRule(ruleLength, value.length >= 8 && value.length <= 20);
    toggleRule(ruleUpper, /[A-Z]/.test(value));                 // at least one capital
    toggleRule(ruleNumber, /\d/.test(value));                  // at least one number
    toggleRule(ruleSpecial, /[@#$%^&*!]/.test(value));         // at least one special
    toggleRule(ruleSpace, !/\s/.test(value));                  // no spaces
  });

  function isPasswordValid(password) {
    return (
      password.length >= 8 &&
      password.length <= 20 &&
      /[A-Z]/.test(password) &&
      /\d/.test(password) &&
      /[@#$%^&*!]/.test(password) &&
      !/\s/.test(password)
    );
  }

  /* ===========================
     REGISTER SUBMIT
  =========================== */
  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    ['fullName','phone','email','password','confirmPassword'].forEach(clearFieldError);
    alertBox.style.display = 'none';

    const name = fullName.value.trim();
    const phoneVal = phone.value.trim();
    const emailVal = email.value.trim();
    const passwordVal = passwordInput.value;
    const confirmPasswordVal = confirmPasswordInput.value;

    let valid = true;

    if (!name) { showFieldError('fullName','Name required'); valid=false; }
    if (!validatePhone(phoneVal)) { showFieldError('phone','Enter valid 10-digit phone'); valid=false; }
    if (!validateEmail(emailVal)) { showFieldError('email','Enter valid email'); valid=false; }

    if (!isPasswordValid(passwordVal)) {
      showFieldError('password','Password must be 8–20 chars, include 1 capital, 1 number & 1 special character');
      valid = false;
    }

    if (passwordVal !== confirmPasswordVal) {
      showFieldError('confirmPassword','Passwords do not match');
      valid = false;
    }

    if (!valid) {
      showAlert('Please fix form errors');
      return;
    }

    try {
      const result = await AUTH.apiRequest('/register', {
        method: 'POST',
        body: JSON.stringify({ 
          name, 
          phone: phoneVal, 
          email: emailVal, 
          password: passwordVal 
        })
      });

      AUTH.showMessage(result.message || "Account created successfully!", "success");
      form.reset();

      setTimeout(() => {
        window.location.href = "login.html";
      }, 1500);

    } catch (err) {
      console.error(err);
      AUTH.showMessage(err.message || "Registration failed", "error");
    }
  });

});
</script>



</body>
</html>
