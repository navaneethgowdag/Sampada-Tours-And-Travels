<!DOCTYPE html>
<html lang="en">
<head>
  <title>Sign Up | Sampada Tours & Travels</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Create an account with Sampada Tours & Travels for exclusive travel packages and benefits">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>

<header class="main-header">
  <div class="logo">
    <a href="index.html">Sampada Tours & Travels</a>
  </div>
  <nav class="main-nav">
    <a href="index.html">Home</a>
    <a href="tours.html">Tours</a>
    <a href="car-rentals.html">Car Rentals</a>
    <a href="contact.html">Contact</a>
  </nav>
  <div class="auth-links" id="authLinks"></div>
</header>

<main class="auth-container">

  <div class="auth-box">

    <h2><i class="fas fa-user-plus"></i> Create Your Account</h2>
    <p class="auth-message">Join Sampada Tours & Travels for exclusive benefits!</p>

    <div id="alertBox" class="alert-box" role="alert" style="display: none;"></div>

    <form id="registerForm" class="auth-form" novalidate>

      <div class="form-group icon-input">
        <label for="fullName">Full Name</label>
        <div class="input-wrapper">
          <i class="fas fa-user icon"></i>
          <input type="text" id="fullName" placeholder="Your full name" required>
        </div>
        <span id="fullNameError" class="error-message" style="display:none;"></span>
      </div>

      <div class="form-group icon-input">
        <label for="phone">Phone Number</label>
        <div class="input-wrapper">
          <i class="fas fa-phone icon"></i>
          <input type="tel" id="phone" placeholder="9876543210" required maxlength="10">
        </div>
        <span id="phoneError" class="error-message" style="display:none;"></span>
      </div>

      <div class="form-group icon-input">
        <label for="email">Email</label>
        <div class="input-wrapper">
          <i class="fas fa-envelope icon"></i>
          <input type="email" id="email" placeholder="your@email.com" required>
        </div>
        <span id="emailError" class="error-message" style="display:none;"></span>
      </div>

      <div class="form-group icon-input">
        <label for="password">Password</label>
        <div class="input-wrapper password-wrapper">
          <i class="fas fa-key icon"></i>
          <input type="password" id="password" placeholder="Create a strong password" required>
          <span class="password-toggle" id="togglePassword"><i class="fas fa-eye"></i></span>
        </div>
        <span id="passwordError" class="error-message" style="display:none;"></span>
      </div>

      <div class="form-group icon-input">
        <label for="confirmPassword">Confirm Password</label>
        <div class="input-wrapper password-wrapper">
          <i class="fas fa-lock icon"></i>
          <input type="password" id="confirmPassword" placeholder="Re-enter password" required>
          <span class="password-toggle" id="toggleConfirmPassword"><i class="fas fa-eye"></i></span>
        </div>
        <span id="confirmPasswordError" class="error-message" style="display:none;"></span>
      </div>

      <button type="submit" class="btn-submit auth-submit-btn" id="submitBtn">
        <i class="fas fa-user-check"></i> Sign Up
      </button>

      <p class="alt-action">
        Already have an account?
        <a href="login.html" class="auth-link">Log In Here</a>
      </p>

    </form>
  </div>
</main>

<footer class="main-footer">
  <div class="footer-content">
    <p>Sampada Tours & Travels</p>
    <p class="address"><i class="fas fa-map-marker-alt"></i> Kirana Bazar Road, Mominpura, Kalaburagi, Karnataka</p>
    <p class="copyright">Â© 2025 Sampada Tours & Travels</p>
  </div>
</footer>

<!-- Central Auth -->
<script src="auth.js"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {
  AUTH.updateAuthUI();
});

/* ===========================
   HELPERS
=========================== */
function showAlert(message, type = 'error') {
  const alertBox = document.getElementById('alertBox');
  alertBox.textContent = message;
  alertBox.className = `alert-box ${type}`;
  alertBox.style.display = 'block';
  setTimeout(() => alertBox.style.display = 'none', 5000);
}

function showFieldError(fieldId, message) {
  const field = document.getElementById(fieldId);
  const errorSpan = document.getElementById(`${fieldId}Error`);
  field.closest('.form-group').classList.add('error');
  errorSpan.textContent = message;
  errorSpan.style.display = 'block';
}

function clearFieldError(fieldId) {
  const field = document.getElementById(fieldId);
  const errorSpan = document.getElementById(`${fieldId}Error`);
  field.closest('.form-group').classList.remove('error');
  errorSpan.textContent = '';
  errorSpan.style.display = 'none';
}

function validateEmail(email) {
  return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email.toLowerCase());
}

function validatePhone(phone) {
  return /^[0-9]{10}$/.test(phone);
}

/* ===========================
   REGISTER SUBMIT
=========================== */
document.getElementById("registerForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  ['fullName','phone','email','password','confirmPassword'].forEach(clearFieldError);
  document.getElementById('alertBox').style.display = 'none';

  const name = fullName.value.trim();
  const phone = phone.value.trim();
  const email = email.value.trim();
  const password = password.value;
  const confirmPassword = confirmPassword.value;

  let valid = true;

  if (!name) { showFieldError('fullName','Name required'); valid=false; }
  if (!validatePhone(phone)) { showFieldError('phone','Enter valid phone'); valid=false; }
  if (!validateEmail(email)) { showFieldError('email','Enter valid email'); valid=false; }
  if (password.length < 8) { showFieldError('password','Minimum 8 characters'); valid=false; }
  if (password !== confirmPassword) { showFieldError('confirmPassword','Passwords do not match'); valid=false; }

  if (!valid) {
    showAlert('Please fix form errors');
    return;
  }

  try {
    const result = await AUTH.apiRequest('/register', {
      method: 'POST',
      body: JSON.stringify({ name, phone, email, password })
    });

    AUTH.showMessage(result.message || "Account created successfully!", "success");
    document.getElementById('registerForm').reset();

    setTimeout(() => {
      window.location.href = "login.html";
    }, 1500);

  } catch (err) {
    console.error(err);
    AUTH.showMessage(err.message || "Registration failed", "error");
  }
});
</script>

</body>
</html>
