<!DOCTYPE html>
<html lang="en">
<head>
  <title>Feedback | Sampada Tours & Travels</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>

<header class="main-header">
  <div class="logo"><a href="index.html">Sampada Tours & Travels</a></div>
  <nav class="main-nav">
    <a href="index.html">Home</a>
    <a href="tours.html">Tours</a>
    <a href="car-rentals.html">Car Rentals</a>
    <a href="booking-dashboard.html" >My Bookings</a>
    <a href="feedback.html" class="active">Feedback</a>
  </nav>
  <div class="auth-links" id="authLinks">
    <!-- Auth UI injected by auth.js -->
  </div>
</header>

<main class="container section">
  <h2><i class="far fa-comment-dots"></i> Send Us Your Feedback</h2>
  <p class="section-description">Your feedback helps us improve our services.</p>

  <div id="alertBox" class="alert-box" style="display:none;"></div>

  <form id="feedbackForm" class="feedback-form">
    <fieldset>
      <legend>Contact Information</legend>
      <div class="form-group">
        <label for="name">Full Name *</label>
        <input type="text" id="name" required>
      </div>
      <div class="form-group">
        <label for="phone">Phone *</label>
        <input type="tel" id="phone" pattern="[0-9]{10}" maxlength="10" required>
      </div>
      <div class="form-group">
        <label for="email">Email</label>
        <input type="email" id="email">
      </div>
    </fieldset>

    <fieldset>
      <legend>Feedback Details</legend>
      <div class="form-group">
        <label for="serviceType">Service Type *</label>
        <select id="serviceType" required>
          <option value="">Select Service</option>
          <option value="Tour Package">Tour Package</option>
          <option value="Car Rental">Car Rental</option>
          <option value="Custom Trip">Custom Trip</option>
          <option value="General Inquiry">General Inquiry</option>
        </select>
      </div>
      <div class="form-group">
        <label for="message">Your Message *</label>
        <textarea id="message" rows="4" placeholder="Tell us about your experience..." required></textarea>
      </div>
    </fieldset>

    <button type="submit" class="btn-submit" id="submitBtn">
      <i class="fas fa-paper-plane"></i> Submit Feedback
    </button>
  </form>
</main>

<footer class="main-footer" role="contentinfo">
  <div class="footer-content">

    <!-- 1) Brand -->
    <p class="footer-brand">Sampada Tours & Travels</p>

    <!-- 2) Contact (primary action) -->
    <p class="footer-contact">
      <i class="fas fa-phone"></i> +91 83106 34274 &nbsp; | &nbsp;
      <i class="fas fa-envelope"></i> sampadatravels777@gmail.com
    </p>
    <!-- 3) Location (map link) -->
    <p class="address">
      <a 
        href="https://www.google.com/maps/search/?api=1&query=Kirana+Bazar+Road,+Mominpura,+Kalaburagi,+Karnataka"
        target="_blank" 
        rel="noopener noreferrer"
        class="map-link"
      >
        <i class="fas fa-map-marker-alt"></i>
        Kirana Bazar Road, Mominpura, Kalaburagi, Karnataka
      </a>
    </p>

    <!-- 4) Legal -->
    <p class="copyright">
      © <span id="year"></span> Sampada Tours & Travels · All rights reserved
    </p>

    <!-- 5) Developer Credit -->
    <p class="dev-credit">
      Developed by <strong>Navaneeth Gowda G</strong>
      &
      <strong>Abhishek Kumar Kolli</strong>
    </p>

  </div>
</footer>

<!-- Central Auth Script -->
<script src="auth.js"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {
  AUTH.updateAuthUI();

  // Prefill name if user is logged in
  const user = AUTH.getCurrentUser();
  if (user && user.username) {
    document.getElementById('name').value = user.username;
  }
});

const form = document.getElementById('feedbackForm');
const alertBox = document.getElementById('alertBox');

// Phone number formatting
document.getElementById('phone').addEventListener('input', e => {
  e.target.value = e.target.value.replace(/\D/g, '');
});

// Submit feedback
form.addEventListener('submit', async e => {
  e.preventDefault();

  const btn = document.getElementById('submitBtn');
  btn.disabled = true;
  btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Sending...';

  const data = {
    service_type: document.getElementById('serviceType').value,
    message: document.getElementById('message').value,
    phone: document.getElementById('phone').value,
    email: document.getElementById('email').value || null,
    name: document.getElementById('name').value
  };

  try {
    const result = await AUTH.apiRequest('/feedback', {
      method: 'POST',
      body: JSON.stringify(data)
    });

    alertBox.textContent = result.message || 'Thank you for your feedback!';
    alertBox.className = 'alert-box success';
    alertBox.style.display = 'block';
    form.reset();

  } catch (err) {
    console.error(err);
    alertBox.textContent = err.message || 'Failed to submit. Please try again.';
    alertBox.className = 'alert-box error';
    alertBox.style.display = 'block';
  } finally {
    btn.disabled = false;
    btn.innerHTML = '<i class="fas fa-paper-plane"></i> Submit Feedback';
  }
});
</script>

</body>
</html>
